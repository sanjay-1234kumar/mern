let DBRefresh,CustomErrorHandler;_e3f‍.x([["default",()=>_e3f‍.o]]);_e3f‍.w("../model",[["DBRefresh",["DBRefresh"],function(v){DBRefresh=v}]]);_e3f‍.w("../service/customErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);


let RefreshToken={


    async deleteRefreshToken(req,res,next){

console.log("this function delet the refresh token which is prsent on the data");


_e3f‍.g.console.log(req.body);

let token=req.body.token;

if(!token){
console.log("req.body.token mai token nahi deya gya hai");
    return next(CustomErrorHandler.unAuthorized('token not found '));
}

// check the token is present on the databse
try {
   
   let refdelete= await DBRefresh.findOne({token:req.body.token});

   _e3f‍.g.console.log(refdelete);

   if(!refdelete){

    return next(CustomErrorHandler.unAuthorized("token not found in the databse"));
   }

   try {
       
    let finalresult=await DBRefresh.findByIdAndDelete(refdelete._id);
    _e3f‍.g.console.log(finalresult);
    return res.json({data:"token is successfully ",status:true});
    
   } catch (error) {
       
    return next(error);

   }
  


    
} catch (error) {
    
    return next(error);
}

      

    }


};







_e3f‍.d(RefreshToken);
